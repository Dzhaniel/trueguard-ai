<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TrueGuard AI ‚Äî –¢–µ–∫—Å–µ—Ä—É</title>
  <link rel="stylesheet" href="/static/styles.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@600;700;800&family=Noto+Sans:wght@400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet"/>
</head>
<body class="app-body">

  <!-- Floating blobs background -->
  <div class="blob-bg">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
    <div class="blob blob-3"></div>
  </div>

  <!-- App nav -->
  <nav class="home-nav">
    <a href="/" class="nav-logo" style="text-decoration:none;">
      <span class="logo-shield">üõ°</span>
      <span class="logo-text">TrueGuard<span class="logo-ai"> AI</span></span>
    </a>
    <span class="nav-status" id="statusPill">‚óè –î–∞–π—ã–Ω</span>
  </nav>

  <!-- Main app layout -->
  <main class="app-main">

    <!-- LEFT: Input panel -->
    <div class="input-panel">
      <div class="panel-header">
        <h2 class="panel-title">–•–∞–±–∞—Ä–ª–∞–º–∞–Ω—ã —Ç–µ–∫—Å–µ—Ä—É</h2>
        <p class="panel-sub">–•–∞—Ç –º”ô—Ç—ñ–Ω—ñ–Ω “õ–æ–π—ã“£—ã–∑ –Ω–µ–º–µ—Å–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∂“Ø–∫—Ç–µ“£—ñ–∑</p>
      </div>

      <!-- Steps indicator -->
      <div class="steps-row">
        <div class="step active" id="step1"><span class="step-num">1</span><span class="step-label">–ú”ô—Ç—ñ–Ω</span></div>
        <div class="step-line"></div>
        <div class="step" id="step2"><span class="step-num">2</span><span class="step-label">–§–æ—Ç–æ</span></div>
        <div class="step-line"></div>
        <div class="step" id="step3"><span class="step-num">3</span><span class="step-label">–¢–µ–∫—Å–µ—Ä—É</span></div>
      </div>

      <!-- Text input with live highlight overlay -->
      <div class="textarea-wrap">
        <div class="textarea-label">–•–∞–±–∞—Ä–ª–∞–º–∞ –º”ô—Ç—ñ–Ω—ñ</div>
        <div class="textarea-container">
          <div class="highlight-layer" id="highlightLayer" aria-hidden="true"></div>
          <textarea
            id="chatText"
            class="chat-textarea"
            placeholder="–•–∞—Ç—Ç—ã –æ—Å—é“ì–∞ –∂–∞–∑—ã“£—ã–∑ –Ω–µ–º–µ—Å–µ “õ–æ–π—ã“£—ã–∑...&#10;–ú—ã—Å–∞–ª—ã: ¬´–°—ñ–∑–¥—ñ“£ –∫–∞—Ä—Ç–∞“£—ã–∑ –±“±“ì–∞—Ç—Ç–∞–ª–¥—ã. –¢–µ–∑ –∫–æ–¥—Ç—ã –∂—ñ–±–µ—Ä—ñ“£—ñ–∑.¬ª"
            rows="7"
            spellcheck="false"
          ></textarea>
        </div>

        <!-- Live signal chips -->
        <div class="signals-row" id="signalsRow">
          <span class="signals-label">üîç –ê–Ω—ã“õ—Ç–∞–ª–¥—ã:</span>
          <div class="chips-container" id="chipsContainer">
            <span class="chip-empty">–°–∏–≥–Ω–∞–ª –∂–æ“õ</span>
          </div>
        </div>
      </div>

      <!-- Photo upload -->
      <div class="photo-section">
        <div class="photo-label">–°–∫—Ä–∏–Ω—à–æ—Ç (–º—ñ–Ω–¥–µ—Ç—Ç—ñ –µ–º–µ—Å)</div>
        <div class="drop-zone" id="dropZone">
          <input type="file" id="photoInput" accept="image/*" style="display:none"/>
          <div class="drop-content" id="dropContent">
            <div class="drop-icon">üì∑</div>
            <div class="drop-text">–°—É—Ä–µ—Ç—Ç—ñ –æ—Å—é“ì–∞ —Ç–∞—Å—Ç–∞“£—ã–∑ –Ω–µ–º–µ—Å–µ <span class="drop-link" onclick="document.getElementById('photoInput').click()">—Ç–∞“£–¥–∞“£—ã–∑</span></div>
            <div class="drop-privacy">üîí –§–æ—Ç–æ —Å–∞“õ—Ç–∞–ª–º–∞–π–¥—ã (—Ç–µ–∫ —Å–∞—É—Å–∞“õ —ñ–∑—ñ)</div>
          </div>
          <div class="drop-preview" id="dropPreview" style="display:none">
            <img id="previewImg" alt="–ñ“Ø–∫—Ç–µ–ª–≥–µ–Ω —Ñ–æ—Ç–æ"/>
            <button class="remove-photo-btn" id="removePhotoBtn">‚úï</button>
          </div>
        </div>
      </div>

      <!-- Submit button -->
      <button class="analyze-btn" id="analyzeBtn">
        <span class="btn-icon">üîç</span>
        <span class="btn-text">–¢–µ–∫—Å–µ—Ä—É</span>
        <span class="btn-loader" id="btnLoader" style="display:none"></span>
      </button>
    </div>

    <!-- RIGHT: Result panel -->
    <div class="result-panel" id="resultPanel">

      <!-- Empty state -->
      <div class="result-empty" id="resultEmpty">
        <div class="empty-icon">üõ°Ô∏è</div>
        <div class="empty-title">–ù”ô—Ç–∏–∂–µ –æ—Å—é–¥–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã</div>
        <div class="empty-sub">–•–∞–±–∞—Ä–ª–∞–º–∞ –∂–∞–∑—ã–ø, ¬´–¢–µ–∫—Å–µ—Ä—É¬ª –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑</div>
      </div>

      <!-- Loading state -->
      <div class="result-loading" id="resultLoading" style="display:none">
        <div class="loading-ring">
          <svg viewBox="0 0 80 80"><circle cx="40" cy="40" r="32" fill="none" stroke-width="6"/></svg>
        </div>
        <div class="loading-text">–ê–Ω–∞–ª–∏–∑–¥–µ—É...</div>
      </div>

      <!-- Error state -->
      <div class="result-error" id="resultError" style="display:none">
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="error-title">“ö–∞—Ç–µ –æ—Ä—ã–Ω –∞–ª–¥—ã</div>
        <div class="error-msg" id="errorMsg"></div>
        <button class="retry-btn" onclick="document.getElementById('analyzeBtn').click()">“ö–∞–π—Ç–∞ –∫”©—Ä—É</button>
      </div>

      <!-- STOP overlay for HIGH risk -->
      <div class="stop-overlay" id="stopOverlay" style="display:none">
        <div class="stop-card">
          <div class="stop-icon">üõë</div>
          <h2 class="stop-title">–¢–û“ö–¢–ê“¢–´–ó!</h2>
          <p class="stop-msg">–ë“±–ª —Ö–∞–±–∞—Ä–ª–∞–º–∞ ‚Äî <strong>”©—Ç–µ “õ–∞—É—ñ–ø—Ç—ñ –∞–ª–∞—è“õ—Ç—ã“õ</strong>.</p>
          <ul class="stop-rules">
            <li>üí≥ –ï—à“õ–∞–Ω–¥–∞–π –∞“õ—à–∞ –∞—É–¥–∞—Ä–º–∞“£—ã–∑</li>
            <li>üîê –ö–æ–¥, IBAN, –ø–∞—Ä–æ–ª—å –±–µ—Ä–º–µ“£—ñ–∑</li>
            <li>üìû –ê–¥–∞–º–¥—ã –±–∞—Å“õ–∞ –Ω”©–º—ñ—Ä–¥–µ–Ω “õ–æ“£—ã—Ä–∞—É —à–∞–ª—ã–ø —Ç–µ–∫—Å–µ—Ä—ñ“£—ñ–∑</li>
          </ul>
          <label class="stop-checkbox">
            <input type="checkbox" id="stopConfirm"/>
            <span>–ú–µ–Ω —Ç“Ø—Å—ñ–Ω–¥—ñ–º –∂”ô–Ω–µ –∂–∞–ª“ì–∞—Å—Ç—ã—Ä—É “õ–∞–ª–∞–º—ã–Ω</span>
          </label>
          <button class="stop-proceed-btn" id="stopProceedBtn" disabled>–ù”ô—Ç–∏–∂–µ–Ω—ñ –∫”©—Ä—É ‚Üí</button>
        </div>
      </div>

      <!-- Main result -->
      <div class="result-main" id="resultMain" style="display:none">

        <!-- Risk badge + score ring -->
        <div class="risk-header">
          <div class="risk-ring-wrap">
            <svg class="risk-ring" viewBox="0 0 120 120" id="riskRingSvg">
              <circle class="ring-track" cx="60" cy="60" r="50" fill="none" stroke-width="10"/>
              <circle class="ring-fill" cx="60" cy="60" r="50" fill="none" stroke-width="10"
                stroke-dasharray="314" stroke-dashoffset="314" id="ringFill"/>
            </svg>
            <div class="ring-score" id="ringScore">0</div>
          </div>
          <div class="risk-info">
            <div class="risk-badge" id="riskBadge">‚Äî</div>
            <div class="risk-type" id="riskType"></div>
            <div class="mini-meters">
              <div class="mini-meter">
                <span>–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è</span>
                <div class="meter-bar"><div class="meter-fill meter-manip" id="manipFill"></div></div>
                <span class="meter-val" id="manipVal">0</span>
              </div>
              <div class="mini-meter">
                <span>–û—Å–∞–ª–¥—ã“õ</span>
                <div class="meter-bar"><div class="meter-fill meter-vuln" id="vulnFill"></div></div>
                <span class="meter-val" id="vulnVal">0</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Evidence reasons -->
        <div class="evidence-section">
          <div class="section-label">üìã –î”ô–ª–µ–ª–¥–µ—Ä</div>
          <ul class="evidence-list" id="evidenceList"></ul>
        </div>

        <!-- Safety Coach bubble -->
        <div class="coach-section">
          <div class="coach-bubble">
            <div class="coach-avatar">ü§ñ</div>
            <div class="coach-content">
              <div class="coach-label">AI –ö–µ“£–µ—Å—à—ñ</div>
              <div class="coach-text" id="coachText"></div>
            </div>
          </div>
        </div>

        <!-- Safe reply tabs -->
        <div class="reply-section">
          <div class="section-label">üí¨ “ö–∞—É—ñ–ø—Å—ñ–∑ –∂–∞—É–∞–ø</div>
          <div class="reply-tabs">
            <button class="tab-btn active" data-tab="polite">–°—ã–ø–∞–π—ã</button>
            <button class="tab-btn" data-tab="short">“ö—ã—Å“õ–∞</button>
            <button class="tab-btn" data-tab="strict">“ö–∞—Ç–∞“£</button>
          </div>
          <div class="reply-box" id="replyBox"></div>
          <button class="copy-btn" id="copyBtn" disabled>
            <span id="copyBtnText">üìã –ö”©—à—ñ—Ä—É</span>
          </button>
          <div class="reply-locked" id="replyLocked" style="display:none">
            üîí –ñ–∞–ª“ì–∞—Å—Ç—ã—Ä—É “Ø—à—ñ–Ω –∂–æ“ì–∞—Ä—ã–¥–∞“ì—ã ¬´–ú–µ–Ω —Ç“Ø—Å—ñ–Ω–¥—ñ–º¬ª –∂–æ–ª–∞“õ—Ç—ã –±–µ–ª–≥—ñ–ª–µ“£—ñ–∑
          </div>
        </div>

        <!-- Cache notice -->
        <div class="cache-notice" id="cacheNotice" style="display:none">
          ‚ö° –ù”ô—Ç–∏–∂–µ –∫—ç—à—Ç–µ–Ω –∞–ª—ã–Ω–¥—ã
        </div>

      </div>

    </div>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>